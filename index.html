<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Get Started (Lua) - Alloverse Documentation</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Get Started (Lua) | Alloverse Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Get Started (Lua)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <meta property="og:description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <link rel="canonical" href="/" /> <meta property="og:url" content="/" /> <meta property="og:site_name" content="Alloverse Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Get Started (Lua)" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://alloverse.com/wp-content/uploads/Alloverse-logo-moniker-256x38-1.svg"}},"description":"Getting started with Alloverse. Guides, code snippets, API references…","headline":"Get Started (Lua)","url":"/","@type":"WebSite","name":"Alloverse Documentation","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <script type="text/javascript" src="/assets/js/custom.js"></script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="/" class="nav-list-link active">Get Started (Lua)</a></li><li class="nav-list-item"><a href="/csharp" class="nav-list-link">Get Started (C#)</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/classes/" class="nav-list-link">AlloUI lua</a><ul class="nav-list "><li class="nav-list-item "><a href="/doc/classes/App.html" class="nav-list-link">App</a></li><li class="nav-list-item "><a href="/doc/classes/Asset.html" class="nav-list-link">Asset</a></li><li class="nav-list-item "><a href="/doc/classes/AssetManager.html" class="nav-list-link">AssetManager</a></li><li class="nav-list-item "><a href="/doc/classes/AssetView.html" class="nav-list-link">AssetView</a></li><li class="nav-list-item "><a href="/doc/classes/Base64Asset.html" class="nav-list-link">Base64Asset</a></li><li class="nav-list-item "><a href="/doc/classes/Bounds.html" class="nav-list-link">Bounds</a></li><li class="nav-list-item "><a href="/doc/classes/Button.html" class="nav-list-link">Button</a></li><li class="nav-list-item "><a href="/doc/classes/Client.html" class="nav-list-link">Client</a></li><li class="nav-list-item "><a href="/doc/classes/Color.html" class="nav-list-link">Color</a></li><li class="nav-list-item "><a href="/doc/classes/Cube.html" class="nav-list-link">Cube</a></li><li class="nav-list-item "><a href="/doc/classes/Entity.html" class="nav-list-link">Entity</a></li><li class="nav-list-item "><a href="/doc/classes/FileAsset.html" class="nav-list-link">FileAsset</a></li><li class="nav-list-item "><a href="/doc/classes/FrameView.html" class="nav-list-link">FrameView</a></li><li class="nav-list-item "><a href="/doc/classes/GrabHandle.html" class="nav-list-link">GrabHandle</a></li><li class="nav-list-item "><a href="/doc/classes/Label.html" class="nav-list-link">Label</a></li><li class="nav-list-item "><a href="/doc/classes/LovrFileAsset.html" class="nav-list-link">LovrFileAsset</a></li><li class="nav-list-item "><a href="/doc/classes/ModelView.html" class="nav-list-link">ModelView</a></li><li class="nav-list-item "><a href="/doc/classes/NavStack.html" class="nav-list-link">NavStack</a></li><li class="nav-list-item "><a href="/doc/classes/Ninepatch.html" class="nav-list-link">Ninepatch</a></li><li class="nav-list-item "><a href="/doc/classes/Pose.html" class="nav-list-link">Pose</a></li><li class="nav-list-item "><a href="/doc/classes/PropertyAnimation.html" class="nav-list-link">PropertyAnimation</a></li><li class="nav-list-item "><a href="/doc/classes/ProxyIconView.html" class="nav-list-link">ProxyIconView</a></li><li class="nav-list-item "><a href="/doc/classes/ResizeHandle.html" class="nav-list-link">ResizeHandle</a></li><li class="nav-list-item "><a href="/doc/classes/Size.html" class="nav-list-link">Size</a></li><li class="nav-list-item "><a href="/doc/classes/Slider.html" class="nav-list-link">Slider</a></li><li class="nav-list-item "><a href="/doc/classes/Speaker.html" class="nav-list-link">Speaker</a></li><li class="nav-list-item "><a href="/doc/classes/StackView.html" class="nav-list-link">StackView</a></li><li class="nav-list-item "><a href="/doc/classes/Surface.html" class="nav-list-link">Surface</a></li><li class="nav-list-item "><a href="/doc/classes/TabView.html" class="nav-list-link">TabView</a></li><li class="nav-list-item "><a href="/doc/classes/TextField.html" class="nav-list-link">TextField</a></li><li class="nav-list-item "><a href="/doc/classes/VideoSurface.html" class="nav-list-link">VideoSurface</a></li><li class="nav-list-item "><a href="/doc/classes/View.html" class="nav-list-link">View</a></li></ul></li><li class="nav-list-item"><a href="/concepts/architecture" class="nav-list-link">Architecture</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/protocol-reference" class="nav-list-link">Protocol Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/protocol-reference/asset-protocols" class="nav-list-link">Asset Protocol</a></li><li class="nav-list-item "><a href="/protocol-reference/coordinate-system" class="nav-list-link">Coordinate System</a></li><li class="nav-list-item "><a href="/protocol-reference/identity" class="nav-list-link">Identity</a></li><li class="nav-list-item "><a href="/protocol-reference/intent" class="nav-list-link">Intent</a></li><li class="nav-list-item "><a href="/protocol-reference/interactions" class="nav-list-link">Interactions</a></li><li class="nav-list-item "><a href="/protocol-reference/state-diffs" class="nav-list-link">State Diffs</a></li><li class="nav-list-item "><a href="/protocol-reference/url-definitions" class="nav-list-link">URL Definitions</a></li><li class="nav-list-item "><a href="/protocol-reference/wire-protocol" class="nav-list-link">Wire Protocol</a></li></ul></li><li class="nav-list-item"><a href="/components" class="nav-list-link">Components</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/community" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/community/contributing" class="nav-list-link">Contributing to Alloverse</a></li><li class="nav-list-item "><a href="/community/code-of-conduct.html" class="nav-list-link">Code of Conduct</a></li></ul></li><li class="nav-list-item"><a href="/hig" class="nav-list-link">3D Interface Design Guidelines</a></li><li class="nav-list-item"><a href="/hosting" class="nav-list-link">Hosting an Alloverse app</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/licenses" class="nav-list-link">Licenses</a><ul class="nav-list "><li class="nav-list-item "><a href="/license/alloverse-license.html" class="nav-list-link">Alloverse License</a></li><li class="nav-list-item "><a href="/licenses/licenses" class="nav-list-link">Licenses used by Alloverse</a></li></ul></li><li class="nav-list-item"><a href="/doc/" class="nav-list-link">Index</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Alloverse Documentation" aria-label="Search Alloverse Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="get-started-lua"> <a href="#get-started-lua" class="anchor-heading" aria-labelledby="get-started-lua"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get Started (Lua) </h1> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#what-is-alloverse" id="markdown-toc-what-is-alloverse">What is Alloverse?</a></li> <li><a href="#developing-an-alloverse-app" id="markdown-toc-developing-an-alloverse-app">Developing an Alloverse App</a></li> <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li> <li><a href="#running-the-alloverse-visor" id="markdown-toc-running-the-alloverse-visor">Running the Alloverse Visor</a></li> <li><a href="#creating-your-project" id="markdown-toc-creating-your-project">Creating your project</a></li> <li><a href="#trying-your-app-out" id="markdown-toc-trying-your-app-out">Trying your app out</a></li> <li><a href="#anatomy-of-hello-world-in-the-alloverse" id="markdown-toc-anatomy-of-hello-world-in-the-alloverse">Anatomy of Hello World in the Alloverse</a></li> <li><a href="#building-your-app" id="markdown-toc-building-your-app">Building your app</a></li> <li><a href="#deploying-your-app" id="markdown-toc-deploying-your-app">Deploying your app</a></li> <li><a href="#celebration" id="markdown-toc-celebration">Celebration</a></li> <li><a href="#advanced-concepts" id="markdown-toc-advanced-concepts">Advanced Concepts</a> <ol> <li><a href="#running-your-own-place-server" id="markdown-toc-running-your-own-place-server">Running your own Place server</a></li> <li><a href="#building-something-more-advanced" id="markdown-toc-building-something-more-advanced">Building something more advanced</a></li> </ol> </li> </ol> </details> <h2 id="what-is-alloverse"> <a href="#what-is-alloverse" class="anchor-heading" aria-labelledby="what-is-alloverse"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is Alloverse? </h2> <p>Alloverse is an open platform for collaborative workspaces in 3D. It’s Gibson-style Cyberspace - but for day-to-day work and play with friends and colleagues. It’s a VR and AR platform for creating spaces, and for running real applications within those spaces, together with other people. In nerd terms, it’s a VR/AR/3D “window manager” and collaborative workspace.</p> <p>For more information, please see the <a href="https://www.alloverse.com" target="_blank">Alloverse website</a>.</p> <ul> <li>Your “Place” is where you decorate, run apps, invite people, and hang out. A “place” is a server. It’s like a collaborative X11 server: It runs a world simulation server, a voip gateway, and all the backing data for 3d UIs for the running apps. (You can check out the <a href="https://github.com/alloverse/alloplace2">reference implementation on Github</a>).</li> <li>A “visor” is the GUI application you use to visit places and interact with your apps. It’s sort of the VR equivalent of a web browser. It’s <a href="https://alloverse.com/download/">what you download from our website to get started</a>. (<a href="https://github.com/alloverse/allovisor"><em>its</em> reference implementation is of course also on github</a>.)</li> <li>An “app” or “alloapp” is a process running on a server, which connects to a Place to show its user interface to people interacting with it. It’s sort of like a web page or X11 process. We’ll be building such an alloapp today.</li> <li>The network and “UI protocol” is taken care of by the <a href="https://github.com/alloverse/allonet">allonet</a> library, written in C and used by all the above projects.</li> </ul> <h2 id="developing-an-alloverse-app"> <a href="#developing-an-alloverse-app" class="anchor-heading" aria-labelledby="developing-an-alloverse-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Developing an Alloverse App </h2> <p>An Alloverse app is a server-side app that you run on your own server, similar to how you would host a web app on your own server. The difference is, when a user goes to your app on the web, it loads into that user’s web browser on their computer; but when a user goes to your alloapp in an Alloverse Place, the app loads into the Place for all users in that Place to use, and your code gets collaboration and VR super-powers for free.</p> <p>This tutorial will take you through creating an Alloverse app using the Lua programming language, since that is the language we’ve developed the most support for so far.</p> <p>You can build apps on Mac, Linux or Windows. On Windows, you’ll need a Unix shell, preferrably WSL2 (but mingw/msys2 could also work if you’re lucky): <a href="https://learn.microsoft.com/en-us/windows/wsl/install">follow this WSL installation guide</a> and install Ubuntu.</p> <p>In contrast to a web framework like Rails or Django, Alloverse doesn’t install any software onto your system. Instead, a project is completely self-contained within its project folder, and contains everything it needs to run.</p> <p>Note that building alloapps is done completely in text (through VSCode and Terminal), and there are currently no graphical editors (like the scene editor you might be used to from Unity or Unreal).</p> <h2 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h2> <p>To write your own Alloverse app, you’ll need the following:</p> <ul> <li>The <a href="https://www.alloverse.com/download/" target="_blank">Alloverse Visor</a> is the official application that serves as the window through which you can view and interact with the Alloverse. At a later stage you should try installing it on a VR headset, but for the purposes of this guide we recommend and assume you’ll be using the desktop version.</li> <li>A terminal app (preinstalled on Mac and Linux, separate install on Windows).</li> <li>A plain text editor for code (We recommend <a href="https://code.visualstudio.com/download" target="_blank">Visual Studio Code</a>).</li> <li>Git (Comes with Xcode on Mac. If you just type <code class="language-plaintext highlighter-rouge">git</code> into a terminal, it’ll ask to install it for you even without Xcode).</li> <li><a href="https://git-lfs.com">Git Large File Storage</a></li> <li>Only on Windows: WSL2 (or if you’re up for some manual work, Cygwin or MingW)</li> </ul> <h2 id="running-the-alloverse-visor"> <a href="#running-the-alloverse-visor" class="anchor-heading" aria-labelledby="running-the-alloverse-visor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Alloverse Visor </h2> <p>Let’s begin by opening the window to Alloverse by getting the Visor running and connected to a Place. Open the app you just downloaded, press the “Connect” button and enter “Sandbox” in the input field. Alternatively, if you’re on a Mac, clicking <a href="alloplace://sandbox.places.alloverse.com/">this link</a> will automatically do the above for you.</p> <p>That’s it - you’re now inside the Alloverse Sandbox Place, providing you a way to view and interact with the app you’ll be developing in the next step.</p> <h2 id="creating-your-project"> <a href="#creating-your-project" class="anchor-heading" aria-labelledby="creating-your-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating your project </h2> <p>Now, let’s use the terminal to create a project folder, and ask AlloAssist to initialize a base project with all dependencies into it. From your terminal:</p> <figure class="highlight"><pre><code class="language-terminal" data-lang="terminal"><span class="gp">$</span><span class="w"> </span><span class="nb">mkdir </span>allo-todo
<span class="gp">$</span><span class="w"> </span><span class="nb">cd </span>allo-todo
<span class="gp">$</span><span class="w"> </span>git init
<span class="gp">$</span><span class="w"> </span>/bin/bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/alloverse/alloapp-assist/master/setup.bash<span class="si">)</span><span class="s2">"</span></code></pre></figure> <p>If all went well so far, you should now be able to run <code class="language-plaintext highlighter-rouge">./allo/assist help</code> to review all available commands. This might also be a good time to run <code class="language-plaintext highlighter-rouge">git commit -a</code>, so the next commit only contains your own changes.</p> <p>Anyway, the curl’d script will have created this project structure for you:</p> <ul> <li><code class="language-plaintext highlighter-rouge">lua</code> contains the Lua source code for your app <ul> <li><code class="language-plaintext highlighter-rouge">lua/main.lua</code> contains your app! It barely does anything yet. But you can add more code to this file to keep going, and add more files into lua to modularize your code.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">images</code> contains images you want to use as textures on buttons, etc.</li> <li><code class="language-plaintext highlighter-rouge">allo</code> contains the Alloverse app framework. You should not edit anything in here, as an upgrade of the framework will overwrite your changes. <ul> <li><code class="language-plaintext highlighter-rouge">allo/assist</code> is a script that helps you with tasks such as starting a server, installing dependencies, etc…</li> <li><code class="language-plaintext highlighter-rouge">allo/libs</code> contains compiled C dependencies as dynamic libraries and executables. These are <code class="language-plaintext highlighter-rouge">.gitignore</code>d to save space. If you check out your code on another computer, you can <code class="language-plaintext highlighter-rouge">./allo/assist fetch</code> to install them again, so you don’t need to (and shouldn’t) commit them.</li> <li><code class="language-plaintext highlighter-rouge">allo/boot.lua</code> sets up the runtime environment for your app. This code is generated, so it’s not recommended to modify this file.</li> </ul> </li> </ul> <h2 id="trying-your-app-out"> <a href="#trying-your-app-out" class="anchor-heading" aria-labelledby="trying-your-app-out"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trying your app out </h2> <p>You should now be able to make your app appear in an Alloplace! In the terminal, run the following command:</p> <figure class="highlight"><pre><code class="language-terminal" data-lang="terminal"><span class="gp">$</span><span class="w"> </span>./allo/assist run alloplace://sandbox.places.alloverse.com</code></pre></figure> <p>If everything checks out, go to the Alloverse Visor, where you should be able to see and interact with the app and its button. (If you’ve moved around in the place, you may need to look around to see it)</p> <p><img src="/assets/images/hello-world-1024x318.jpg" alt="On the left, the UI of our app shown as a white rectangle with an orange button. On the right, a terminal showing the assist run command that instantiates the app; and the word Hello printed thrice." title="Hello world running inside Alloverse" /> <em>Our app running in Nevyn’s place. I’ve clicked our simple app’s orange button button three times, and the laws of causality held up, printing “Hello” thrice to our terminal.</em></p> <p>At this point, you could go off, do your own thing, read the documentation as you go. Or you could keep reading, and be guided through the development of a simple but functional todo list app, which will help establish the fundamentals and make it much easier for you to build real, complex apps.</p> <p>If your app ever disappears, take a look around in the Alloverse to make sure you’re not just looking in the wrong direction. If you still can’t see it, it might have crashed. Check out the terminal from which you ran it - there should be error messages to help you figure out what went wrong.</p> <p>This is also a good point at which to remind you: if you get stuck, or have questions or feedback, please <a href="https://discord.gg/KhdMU6P6Uw" target="_blank">hop on Discord</a> and give it to us straight.</p> <h2 id="anatomy-of-hello-world-in-the-alloverse"> <a href="#anatomy-of-hello-world-in-the-alloverse" class="anchor-heading" aria-labelledby="anatomy-of-hello-world-in-the-alloverse"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Anatomy of Hello World in the Alloverse </h2> <p>Let’s open up <code class="language-plaintext highlighter-rouge">lua/main.lua</code> and have a look at the code, to understand what’s going on. If you’re not much for theory, you may skip this section and get straight to <a href="#building-your-app">making an app</a>.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span>
  <span class="n">arg</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
  <span class="s2">"allo-todo2"</span>
<span class="p">)</span>
<span class="kd">local</span> <span class="n">app</span> <span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">client</span><span class="p">)</span></code></pre></figure> <p>Above, we’re using a Client to connect this app to a Place. <code class="language-plaintext highlighter-rouge">arg[2]</code> is the URL of the place to connect to, which Assist sets up for you in boot.lua. App then manages the Client connection for you, and manages the lifetime of your app.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">assets</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">quit</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/quit.png"</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="n">assetManager</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span></code></pre></figure> <p>Assets are files (images, glb models, videos, sounds, etc…) that you want to use in your app. They need to be published so that users’ visors can download them before you can use them. We make <code class="language-plaintext highlighter-rouge">assets</code> global so you can use it throughout your app.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">mainView</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">))</span>
<span class="n">mainView</span><span class="p">.</span><span class="n">grabbable</span> <span class="o">=</span> <span class="kc">true</span></code></pre></figure> <p>Your application is represented by a hierarchy of views. If you’re a web developer, you can think of it as nested elements in a DOM. If you come from Unity, it’s similar to the GameObject hierarchy, with transforms being relative to parent GameObjects. If you’re an oldschool Macintosh Toolbox developer, I’m sorry.</p> <p><code class="language-plaintext highlighter-rouge">app.mainView</code> is the main UI for your app. You should set it up with your main user interface before connecting to the Place.</p> <p><code class="language-plaintext highlighter-rouge">Bounds</code> is the position and size of your object:</p> <ul> <li>The first three numbers defines the x, y and z positions (see: <a href="/protocol-reference/coordinate-system" target="_blank">coordinate space reference</a>). In this case, <code class="language-plaintext highlighter-rouge">0, 1.2, -2</code> means the <code class="language-plaintext highlighter-rouge">mainView</code> is centered horizontally 1.2 meters up from the floor and 2 meters into the Place, depth-wise.</li> <li>The second triplet of numbers refers to the object’s width, depth and height. In this case, <code class="language-plaintext highlighter-rouge">1, 0.5, 0.01</code> defines the object as being 1 meter wide, half a meter tall, and one centimeter deep.</li> </ul> <p>We also make the main view <code class="language-plaintext highlighter-rouge">grabbable</code>, so the user can move it around the Place. Alternatively, you can add a GrabHandle, which acts like the title bar of a desktop UI’s window.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">button</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span>
<span class="n">mainView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
<span class="n">button</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure> <p>The standard template has created a standard Button component for you, at 2 decimeters wide and tall. Its position of 5 centimeter down and forward is relative to its parent - in this case the <code class="language-plaintext highlighter-rouge">mainView</code>.</p> <p>The <code class="language-plaintext highlighter-rouge">onActivated</code> callback lets us run code when the button is pressed. This’ll print “hello” to your local terminal when you run the app on your machine (even if you’re running the visor somewhere else on the Internet)!</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">app</span><span class="p">.</span><span class="n">mainView</span> <span class="o">=</span> <span class="n">mainView</span>
<span class="n">app</span><span class="p">:</span><span class="n">connect</span><span class="p">()</span>
<span class="n">app</span><span class="p">:</span><span class="n">run</span><span class="p">()</span></code></pre></figure> <p>Finally, the template has configured the app’s <code class="language-plaintext highlighter-rouge">mainView</code> to use this dummy UI. Then, it connects to the Place we’ve been asked to run in, and finally hands over the runtime of the app to the UI framework so it keeps running until the user quits it.</p> <p>Now that we got the gist of how to compose an app like this, we can replace it with something useful.</p> <h2 id="building-your-app"> <a href="#building-your-app" class="anchor-heading" aria-labelledby="building-your-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building your app </h2> <p>Let’s make a todo list app! I’m a master artist, so I’ve painted this piece of art to represent our goal:</p> <p><img src="/assets/images/todo-sketch.jpeg" alt="Todo list app sketch" /></p> <p>So we’ve got:</p> <ul> <li>A list of items to check off,</li> <li>A button to add an item</li> <li>A dialog that pops up where you can name your item.</li> </ul> <p>Sounds great. Let’s get started.</p> <p class="label label-green">Note: This is where we start coding for real.</p> <p>Select everything from (and including) <code class="language-plaintext highlighter-rouge">local mainView = ...</code> down to <code class="language-plaintext highlighter-rouge">app.mainView = mainView</code> and delete it, and we’ll write some new, fun code.</p> <p>Instead of having a bunch of loose views strewn around the code, I enjoy creating a class for each main container of UI. Some equivalent of a “window”, or “view controller”, or “component” if you will. Let’s create a <code class="language-plaintext highlighter-rouge">TodosView</code>, which will display the list of items, and allow you to quit the app, and add new items. Copy the code block below, and paste it between <code class="language-plaintext highlighter-rouge">app.assetManager:add(assets)</code> and <code class="language-plaintext highlighter-rouge">app:connect()</code>.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">class</span><span class="p">.</span><span class="n">TodosView</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">_init</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
  <span class="n">self</span><span class="p">:</span><span class="n">super</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">grabbable</span> <span class="o">=</span> <span class="kc">true</span>

  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span> <span class="o">=</span> <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
    <span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)</span>
  <span class="p">}))</span>
  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">:</span><span class="n">setDefaultTexture</span><span class="p">(</span><span class="n">assets</span><span class="p">.</span><span class="n">quit</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
      <span class="n">app</span><span class="p">:</span><span class="n">quit</span><span class="p">()</span>
  <span class="k">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">addButton</span> <span class="o">=</span> <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
    <span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)</span>
  <span class="p">}))</span>
  <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Add todo"</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
    <span class="n">self</span><span class="p">:</span><span class="n">showNewTodoPopup</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">todoViews</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>We’re using <a href="https://stevedonovan.github.io/Penlight/api/libraries/pl.class.html" target="_blank">Penlight’s <code class="language-plaintext highlighter-rouge">class</code> macro</a> to create classes. We inherit <a href="/doc/classes/Surface.html" target="_blank">ui.Surface</a>, which is like a <a href="/doc/classes/View.html" target="_blank">ui.View</a> except it also draws a background, so our app gets a backdrop to rest our controls onto.</p> <p>We create a constructor, where we set up initial state and controls. Here we want a quit <a href="/doc/classes/Button.html" target="_blank">Button</a>, and an add <a href="/doc/classes/Button.html" target="_blank">Button</a>. We immediately add them as subviews to the TodosView, so they show up in the view hierarchy. For the first button, we use one of our image assets as a texture, and for the other, we set the text on the label instead.</p> <p>AlloUI doesn’t have a comprehensive layout system itself, so we’ll call our own <code class="language-plaintext highlighter-rouge">layout</code> at opportune moments. Let’s stub it out so we have something to start with. We’ll also create an instance of it, and use it as our app’s main view. Paste the following into your code, just below the <code class="language-plaintext highlighter-rouge">_init</code> function:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">.</span><span class="mi">52</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">app</span><span class="p">.</span><span class="n">mainView</span> <span class="o">=</span> <span class="n">TodosView</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">))</span></code></pre></figure> <p>Let’s restart your app to see your new code changes. Open the terminal where your app is running, and quit it with ctrl-C. Then, fire off a quick <code class="language-plaintext highlighter-rouge">./allo/assist run alloplace://sandbox.places.alloverse.com</code> in your terminal, and you’ll be presented with this beauty in Alloverse:</p> <p><img src="/assets/images/todo-progress-1.png" alt="A white surface with a close button in the top right, and an 'add todo' button along the bottom" /></p> <p>We’ve created a VR interface, how cool is that!? Just keep in mind that while the “Add todo” button is is visible, clicking it will cause the app to crash. So, let’s attach some functionality to it: let’s make it create that popup for inputting new todo items. Paste the following code block right underneath the <code class="language-plaintext highlighter-rouge">layout()</code> function:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">showNewTodoPopup</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">popup</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)})</span>

  <span class="kd">local</span> <span class="n">input</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">TextField</span><span class="p">{</span>
    <span class="n">bounds</span><span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="kd">local</span> <span class="n">done</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
    <span class="n">self</span><span class="p">:</span><span class="n">addTodo</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">popup</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
  <span class="k">end</span>
  <span class="n">input</span><span class="p">.</span><span class="n">onReturn</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
    <span class="n">done</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">false</span>
  <span class="k">end</span>
  <span class="n">input</span><span class="p">:</span><span class="n">askToFocus</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>

  <span class="kd">local</span> <span class="n">addButton</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">popup</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
  <span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
  <span class="n">addButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Add"</span><span class="p">)</span>
  <span class="n">addButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="n">done</span>

  <span class="kd">local</span> <span class="n">cancelButton</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">popup</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
  <span class="n">cancelButton</span><span class="p">:</span><span class="n">setColor</span><span class="p">({</span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
  <span class="n">cancelButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
  <span class="n">cancelButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Cancel"</span><span class="p">)</span>
  <span class="n">cancelButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
    <span class="n">popup</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
  <span class="k">end</span>

  <span class="n">app</span><span class="p">:</span><span class="n">openPopupNearHand</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="n">hand</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure> <p>Phew, that’s a handful. Let’s step through it.</p> <ul> <li><code class="language-plaintext highlighter-rouge">popup</code> is our new popup window. It’s another surface, one meter by a half.</li> <li>To it, we add a <a href="/doc/classes/TextField.html" target="_blank">TextField</a>! This is your standard issue text input view. Tapping it will give it focus, allowing you to type something in it with your keyboard. (If you would do this while using the Alloverse headset app, it will display a virtual keyboard for you to use.</li> <li>We want to close the popup both when the return key is pressed, and when you manually tap the “Add” button, so let’s create a callback we can use for both called <code class="language-plaintext highlighter-rouge">done</code>.</li> <li><code class="language-plaintext highlighter-rouge">onReturn</code> is used to react to return/enter key, and we can also use it to make sure a newline character isn’t added to the text.</li> <li><code class="language-plaintext highlighter-rouge">showNewTodoPopup</code> has been called with a <code class="language-plaintext highlighter-rouge">hand</code>. That’s the hand of the user that tapped the “Add todo button”. It belongs to an avatar, so we can actually ask the avatar if it would pretty please focus this text field, so the user can begin typing in it directly? If you’d be so kind.</li> <li>The <code class="language-plaintext highlighter-rouge">addButton</code> uses the same <code class="language-plaintext highlighter-rouge">done</code> callback as <code class="language-plaintext highlighter-rouge">onReturn</code></li> <li><code class="language-plaintext highlighter-rouge">cancelButton</code> just closes the popup, no questions asked.</li> <li>Finally, <code class="language-plaintext highlighter-rouge">app:openPopupNearHand</code> will display our new fancy popup 60 centimeters away from the user’s hand, which is a convenient distance at which to do your job.</li> </ul> <p class="label label-yellow">Warning: incoming rant</p> <p>The cool thing about this popup is that if you have multiple people in the room, they can all get their own input popup, so they can add their own items without interfering with each other. This is an important and unusual aspect of UI design and development: all your UI is real time collaborative, so you have to consider how your application behaves when multiple people use it at the same time.</p> <p>For example, if you had added the input field directly to the main view, only one user would’ve been able to add items at a time, and they’d likely have interfered with each other’s work. By using a personal popup, users can work naturally collaboratively and in tandem.</p> <p class="label label-green">Relax: rant over.</p> <p>Here’s what this new fancy popup should look like once you tap the “Add todo” button:</p> <p><img src="/assets/images/todo-progress-2.png" alt="A white surface with a text field, an 'add' button, and a 'cancel' button." /></p> <p>Before we continue, we’ll need another asset. Download <img src="/assets/images/checkmark.png" alt="" /> <a href="/assets/images/checkmark.png">checkmark.png</a> and put it in <code class="language-plaintext highlighter-rouge">images/</code>. Then we’ll have to refer to it from code. At the top of your file, you’re already loading the <code class="language-plaintext highlighter-rouge">quit</code> texture asset. Modify that block to also load and publish the <code class="language-plaintext highlighter-rouge">checkmark</code> texture, by making the code block look like this:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">assets</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">quit</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/quit.png"</span><span class="p">),</span>
  <span class="n">checkmark</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/checkmark.png"</span><span class="p">),</span>
<span class="p">}</span></code></pre></figure> <p>Cool. Cool cool cool. Let’s make it actually possible to add todo items, yeah? Add these two functions below your existing ones:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">addTodo</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">todoView</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">View</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)})</span>
  
  <span class="kd">local</span> <span class="n">checkButton</span> <span class="o">=</span> <span class="n">todoView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
  <span class="n">checkButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="o">-</span><span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">checkButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">checkButton</span><span class="p">:</span><span class="n">setDefaultTexture</span><span class="p">(</span><span class="n">assets</span><span class="p">.</span><span class="n">checkmark</span><span class="p">)</span>
  <span class="n">checkButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
    <span class="n">self</span><span class="p">:</span><span class="n">removeTodo</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="kd">local</span> <span class="n">label</span> <span class="o">=</span> <span class="n">todoView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Label</span><span class="p">{</span>
    <span class="n">bounds</span><span class="o">=</span> <span class="n">todoView</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">copy</span><span class="p">():</span><span class="n">inset</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
    <span class="n">halign</span><span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span> <span class="n">text</span>
  <span class="p">})</span>

  <span class="nb">table.insert</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">todoView</span><span class="p">)</span>
  <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
  <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">removeTodo</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">index</span> <span class="o">=</span> <span class="n">tablex</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">todoView</span><span class="p">)</span>
  <span class="nb">table.remove</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
  <span class="n">todoView</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
  <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>This should start to look familiar.</p> <ul> <li><code class="language-plaintext highlighter-rouge">todoView</code> is the parent view of all the controls related to the todo list item. We store them in <code class="language-plaintext highlighter-rouge">self.todoViews</code> so we can layout them properly later.</li> <li><code class="language-plaintext highlighter-rouge">checkButton</code> is used to check off a completed item. We place it along the left edge, tell it to use our new fancy checkmark texture, and configure it to call an as-of-yet nonexistent <code class="language-plaintext highlighter-rouge">removeTodo</code> method.</li> <li><code class="language-plaintext highlighter-rouge">label</code> is the text label describing our item. Text is black (that’s a list of Red, Green, Blue and Alpha, with components from 0.0 to 1.0), horizontally aligned to the left, with the text from the user.</li> <li>We call <code class="language-plaintext highlighter-rouge">layout</code> so our new item is positioned correctly</li> <li>And then we add it as a subview, yay!</li> </ul> <p><code class="language-plaintext highlighter-rouge">removeTodo</code> just finds the given item in the list, and removes it from both the list and the UI, running a relayouting pass to adjust the other items’ positions.</p> <p>That’s awesome! We can now add and remove todo list items! Just one bummer: they all end up stacked on top of each other. We’ll need to lay them out before this is usable. Let’s replace our dummy <code class="language-plaintext highlighter-rouge">layout</code> with something better. Remove the existing contents of your <code class="language-plaintext highlighter-rouge">layout</code> function, and type in this:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
  <span class="kd">local</span> <span class="n">height</span> <span class="o">=</span> <span class="o">#</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span>

  <span class="kd">local</span> <span class="n">pen</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
    <span class="n">size</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">:</span><span class="n">copy</span><span class="p">(),</span>
    <span class="n">pose</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Pose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">depth</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">07</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">:</span><span class="n">setBounds</span><span class="p">(</span><span class="n">pen</span><span class="p">:</span><span class="n">copy</span><span class="p">())</span>
  <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">v</span><span class="p">:</span><span class="n">setBounds</span><span class="p">(</span><span class="n">pen</span><span class="p">:</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">.</span><span class="mi">52</span><span class="p">,</span> <span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
  <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">:</span><span class="n">setBounds</span><span class="p">()</span>

  <span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
  <span class="n">self</span><span class="p">:</span><span class="n">setBounds</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>Here’s a pattern I’ve brought with me all the way back from building black-and-white Mac apps in the 80s: using a <code class="language-plaintext highlighter-rouge">pen</code> variable which represents a rectangle (or rather, a 3D box!) where we want to “stamp out” our UI, moving the pen as we walk through our items.</p> <ul> <li>We want to adjust the height of our UI to exactly fit our items. Each item is 13 cm tall, and then there’s 25 cm of padding for the “Add todos” button.</li> <li>The add button’s size is a perfect template for our pen. Let’s start the pen at the bottom of the window and lay out controls bottom-to-top, and also move it out from the surface so that our elements sit ON TOP of the surface, instead of embedded in it.</li> <li>Let’s add 7 cm of initial padding</li> <li>There. Stamp the pen’s current state into the add button’s bounds.</li> <li>Add another 15 cm of padding.</li> <li>Stamp the pen onto each todo item view, adding 13 cm of padding for each item.</li> <li>Figure out the perfect new location for the quit button, and…</li> <li>Set the height of the whole app to the one we calculated at the start, and update the bounds so it’s reflected on the users’ headsets.</li> </ul> <p>You know what? I think this is pretty stellar. This’ll do nicely. If you dotted every i, your app should look something like this:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/49U9tVUoeZU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <h2 id="deploying-your-app"> <a href="#deploying-your-app" class="anchor-heading" aria-labelledby="deploying-your-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploying your app </h2> <p>So, you built your fancy VR app. Now you want to show it off, and deploy it so all the Alloverse users in the world can run it in their places, right?</p> <p>Well, you’re in luck! Go ahead and learn about <a href="/hosting">hosting an Alloverse app</a>!</p> <h2 id="celebration"> <a href="#celebration" class="anchor-heading" aria-labelledby="celebration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Celebration </h2> <p>If you made it this far, go eat a cinnamon roll, you deserve it. It’s on me. Really, just <a href="https://discord.gg/KhdMU6P6Uw">ping me on Discord</a> and it’s yours. We’d at least love to hear from you, and see your creations.</p> <p>Once you make your own apps, even if you’re not down with cinnamon rolls, do let us know, so we can feature your app in our app browser, blog and tweet about it, etc etc.</p> <h2 id="advanced-concepts"> <a href="#advanced-concepts" class="anchor-heading" aria-labelledby="advanced-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced Concepts </h2> <h3 id="running-your-own-place-server"> <a href="#running-your-own-place-server" class="anchor-heading" aria-labelledby="running-your-own-place-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running your own Place server </h3> <p>If you’re feeling ambitious, you can boot a Place of your own using the <code class="language-plaintext highlighter-rouge">docker run -e ALLOPLACE_NAME="my place" -p 21337:21337/udp -it alloverse/alloplace2</code> command. In the Alloverse connect input, enter the name of the place you just created.</p> <h3 id="building-something-more-advanced"> <a href="#building-something-more-advanced" class="anchor-heading" aria-labelledby="building-something-more-advanced"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building something more advanced </h3> <ul> <li><a href="https://alloverse.com/2022/02/03/how-to-make-a-retro-arcade-in-a-week-101/">How to build a VR retro arcade</a> on our blog steps you through building a SNES emulator in VR.</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
